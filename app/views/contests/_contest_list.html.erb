<div id="contests">
<div class="inner"><%= javascript_include_tag :defaults %>
  <div class="flash" id="flash">
    <% flash.each do |type, message| -%>
    <div class="message <%= type %>">
      <p>
        <%= message %>
      </p>
    </div>
    <% end -%>
    <% flash.discard -%>
  </div>
  <table class="table">
    <tr>
      <th></th>
      <th>
        <%= t("activerecord.attributes.contest.contest", :default => t("activerecord.labels.contest", :default => "Contest")) %>
      </th>
      <th>
        <%= t("activerecord.attributes.contest.candidates", :default => t("activerecord.labels.candidates", :default => "Candidates")) %>
      </th>
      <th class="last">
        &nbsp;
      </th>
    </tr>
    <% @contests = election.contests.paginate :per_page => 10, :page => page, :order => "position" if @contests.nil?%>
    <% @contests.sort!{|c1,c2|c1.position <=> c2.position} %>
    <% @contests.each do |contest| -%>
    <tr class="<%= cycle("odd", "even") %>">
      <td>
         <% unless current_context.election.nil? -%> 
           <%= link_to_remote image_tag("ui_icons/uparrow.png", :border=>0, :alt => "Move contest up"), :url => move_contest_path(:id=>contest.id, :direction=>"up"), :method => :get %>
           <%= link_to_remote image_tag("ui_icons/downarrow.png",:border=>0, :alt => "Move contest down"), :url => move_contest_path(:id=>contest.id, :direction=>"down"), :update => 'contests', :method => :put, :complete => "new Effect.Highlight('contests')", :page => params[:page] %>
        <% end -%>
      </td>
      <td>
        <%= link_to contest.display_name, contest_path(contest) %>
      </td>
      <td>
        <%= contest.candidates.count %>
      </td>
      <td class="last">
        <%= link_to "#{t("web-app-theme.show", :default => "Show")}", contest_path(contest) %>|<%= link_to "#{t("web-app-theme.edit", :default => "Edit")}", edit_contest_path(contest) %>|<%= link_to "#{t("web-app-theme.delete", :default => "Delete")}", contest_path(contest), :method => :delete, :confirm => "#{t("web-app-theme.confirm", :default => "Are you sure?")}" %>
      </td>      
    </tr>
    <% end -%>
  </table>
  <div class="actions-bar wat-cf">
    <div class="actions">
      <%= link_to "#{t("web-app-theme.new", :default => "Add new contest")}", :controller => "contests", :action => "new" %> 
    </div>
    <%= will_paginate @contests, :class => 'pagination ajax'%>
  </div>
</div>
</div>
